<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="theme-color" content="#1b1b1b">
	<title>247CTF Easy Challs [ Reversing ] | H4ns&#39; blog</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="247CTF Easy Challs [ Reversing ]" />
<meta property="og:description" content="In this post I will show the solution to the easiest challenges in the Reversing category.
The More The Merrier When opening the main code in the IDA tool we notice that there is a variable called unk_6E8 which is moving its content to the rax register.
Let&rsquo;s see what&rsquo;s inside.
We note that inside the variable is the flag we were looking for. It does not show us these characters if we launch the strings command because each character is separated from the next by 3 bytes." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://h4ns21.github.io/blog/post/rever247ez/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-02-28T15:23:29-05:00" />
<meta property="article:modified_time" content="2022-02-28T15:23:29-05:00" />


		<meta itemprop="name" content="247CTF Easy Challs [ Reversing ]">
<meta itemprop="description" content="In this post I will show the solution to the easiest challenges in the Reversing category.
The More The Merrier When opening the main code in the IDA tool we notice that there is a variable called unk_6E8 which is moving its content to the rax register.
Let&rsquo;s see what&rsquo;s inside.
We note that inside the variable is the flag we were looking for. It does not show us these characters if we launch the strings command because each character is separated from the next by 3 bytes."><meta itemprop="datePublished" content="2022-02-28T15:23:29-05:00" />
<meta itemprop="dateModified" content="2022-02-28T15:23:29-05:00" />
<meta itemprop="wordCount" content="430">
<meta itemprop="keywords" content="" />
		<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="247CTF Easy Challs [ Reversing ]"/>
<meta name="twitter:description" content="In this post I will show the solution to the easiest challenges in the Reversing category.
The More The Merrier When opening the main code in the IDA tool we notice that there is a variable called unk_6E8 which is moving its content to the rax register.
Let&rsquo;s see what&rsquo;s inside.
We note that inside the variable is the flag we were looking for. It does not show us these characters if we launch the strings command because each character is separated from the next by 3 bytes."/>

	<link rel="stylesheet" href="/blog/css/bundle.css">
	<link rel="stylesheet" href="/blog/css/custom.css">
	<link rel="stylesheet" href="/blog/css/themes/dark-blue.css">
	<link rel="icon" href="/blog/icons/16.png" sizes="16x16" type="image/png">
	<link rel="icon" href="/blog/icons/32.png" sizes="32x32" type="image/png">
	<link rel="manifest" href="/blog/manifest.json">
		
</head>
<body class="body kind-page">
	<header class="header">
	<a class="logo" href="/blog/">H4ns&#39; blog</a>
	
</header>
	<div class="primary">
	
	<main class="main">
		
<nav class="breadcrumb block" aria-label="breadcrumb">
	<ol class="breadcrumb__list">
		
		<li class="breadcrumb__item">
			<a class="breadcrumbs__link" href="/blog/">Challs</a>
		</li>
		<li class="breadcrumb__item">
			<a class="breadcrumbs__link" href="/blog/post/">Posts</a>
		</li>
		<li class="breadcrumbs__item breadcrumb__item--active" aria-current="page">247CTF Easy Challs [ Reversing ]</li>
	</ol>
</nav>
		<div class="single block">
			<article class="entry">
	<div class="entry__meta meta mb">
	<time class="entry__meta-published meta-published" datetime="2022-02-28T15:23:29-05:00">February 28, 2022</time>
	</div>
				<h1 class="entry__title">247CTF Easy Challs [ Reversing ]</h1>
<details class="entry__toc toc" open>
	<summary class="toc__title">Table of Contents</summary>
	<nav id="TableOfContents">
  <ul>
    <li><a href="#__the-more-the-merrier__"><strong>The More The Merrier</strong></a></li>
    <li><a href="#__the-encrypted-password__"><strong>The Encrypted Password</strong></a></li>
  </ul>
</nav>
</details>
				<div class="entry__content"><p>In this post I will show the solution to the easiest challenges in the Reversing category.</p>
<h2 id="__the-more-the-merrier__"><strong>The More The Merrier</strong></h2>
<p><img src="https://user-images.githubusercontent.com/88755387/156053671-4bb25f34-3f03-4ec0-b54a-a356cde535d8.png" alt="image"></p>
<p>When opening the main code in the IDA tool we notice that there is a variable called <code>unk_6E8</code> which is moving its content to the rax register.</p>
<p><img src="https://user-images.githubusercontent.com/88755387/156054315-fbe42ef0-2129-40f4-92fe-f53a9083eae2.png" alt="image"></p>
<p>Let&rsquo;s see what&rsquo;s inside.</p>
<p><img src="https://user-images.githubusercontent.com/88755387/156055740-72794539-6db7-4e4a-ab02-49537b0d6ced.png" alt="image"></p>
<p>We note that inside the variable is the flag we were looking for. It does not show us these characters if we launch the <code>strings</code> command because each character is separated from the next by 3 bytes.</p>
<h2 id="__the-encrypted-password__"><strong>The Encrypted Password</strong></h2>
<p>This challenge is a little more complicated than the previous one but nothing that cannot be overcome.</p>
<p><img src="https://user-images.githubusercontent.com/88755387/156056808-72f45c8c-3e34-4b2e-a73d-c5c4062c8008.png" alt="image"></p>
<p>Let&rsquo;s start the challenge by running it and see what it asks of us.</p>
<p><img src="https://user-images.githubusercontent.com/88755387/156058151-5861690d-2fe6-42b9-a5c3-83a9c44960e4.png" alt="image"></p>
<p>We may think that entering the secret password will return the flag we are looking for.</p>
<p>Let&rsquo;s open the program in Ghidra to analyze the main function.</p>
<p><img src="https://user-images.githubusercontent.com/88755387/156058929-f599dbf5-247b-4351-8f20-629610e724aa.png" alt="image"></p>
<p>We can see that the variable <code>local_48</code> stores what we enter when we are asked for the password, so we are going to rename it as <code>user_input</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">puts(<span style="color:#e6db74">&#34;Enter the secret password:&#34;</span>);   
fgets(local_48,<span style="color:#ae81ff">0x21</span>,stdin);
</code></pre></div><p>If we continue reading we will realize that a comparison is made between what we have written and a variable called <code>local_78</code> which we do not know what it has inside.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">  puts(<span style="color:#e6db74">&#34;Enter the secret password:&#34;</span>);   
  fgets(user_input,<span style="color:#ae81ff">0x21</span>,stdin);   
  iVar2 <span style="color:#f92672">=</span> strcmp(user_input,(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>local_78);   
  <span style="color:#66d9ef">if</span> (iVar2 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {     
    printf(<span style="color:#e6db74">&#34;You found the flag!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">247CTF{%s}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,<span style="color:#f92672">&amp;</span>local_78);   
  }
</code></pre></div><p>To better visualize this we will use the <code>ltrace</code> command which will help us to locate the content.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ltrace ./encrypted_password
</code></pre></div><p><img src="https://user-images.githubusercontent.com/88755387/156061067-f868d09d-d7da-49fb-98c7-060b129c3f23.png" alt="image"></p>
<p>Once we know what you are comparing us to, we are going to throw the string at the program.</p>
<p><img src="https://user-images.githubusercontent.com/88755387/156061280-5293c324-4d3d-4fa5-bb84-06c6080042fe.png" alt="image"></p>
<p>This challenge can also be solved with the <code>Angr</code> tool, which is defined in the official <a href="https://docs.angr.io/">documentation</a>.</p>
<pre tabindex="0"><code>angr is a multi-architecture binary analysis toolkit, with the capability to perform dynamic symbolic execution (like Mayhem, KLEE, etc.) and various static analyses on binaries.
</code></pre><p>We are going to use the <code>.explore()</code> method with the <code>find</code> argument, this will cause the program to run until it finds a state with the search condition, in this case the word <code>found</code>.</p>
<pre tabindex="0"><code>An extremely common operation in symbolic execution is to find a state that reaches a certain address, while discarding all states that go through another address. Simulation manager has a shortcut for this pattern, the .explore() method.
</code></pre><p>Once we have understood how the tool works we are going to create a script to display the flag.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> angr

proj <span style="color:#f92672">=</span> angr<span style="color:#f92672">.</span>Project(<span style="color:#e6db74">&#39;./encrypted_password&#39;</span>)

simgr <span style="color:#f92672">=</span> proj<span style="color:#f92672">.</span>factory<span style="color:#f92672">.</span>simgr()

simgr<span style="color:#f92672">.</span>explore(find<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> s: <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;found&#34;</span> <span style="color:#f92672">in</span> s<span style="color:#f92672">.</span>posix<span style="color:#f92672">.</span>dumps(<span style="color:#ae81ff">1</span>))

s <span style="color:#f92672">=</span> simgr<span style="color:#f92672">.</span>found[<span style="color:#ae81ff">0</span>]
print(s<span style="color:#f92672">.</span>posix<span style="color:#f92672">.</span>dumps(<span style="color:#ae81ff">1</span>))
flag <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>posix<span style="color:#f92672">.</span>dumps(<span style="color:#ae81ff">0</span>)
print(flag)
</code></pre></div><p><img src="https://user-images.githubusercontent.com/88755387/156063295-92456bf2-44ca-4294-899c-e7cba99000bf.png" alt="image"></p>
<p>I hope you liked the writeups! :D</p>
</div>
				
				<footer class="entry__footer">
					
					
<div class="entry__share share">
	<a class="share__link btn" title="Share on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fh4ns21.github.io%2fblog%2fpost%2frever247ez%2f" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Share on Facebook', 'width=800,height=600,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Facebook" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M330 512V322h64l9-74h-73v-47c0-22 6-36 37-36h39V99c-7-1-30-3-57-3-57 0-95 34-95 98v54h-64v74h64v190z"/></svg>
	</a>
	<a class="share__link btn" title="Share on Twitter" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fh4ns21.github.io%2fblog%2fpost%2frever247ez%2f&amp;text=247CTF%20Easy%20Challs%20%5b%20Reversing%20%5d" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Share on Twitter', 'width=800,height=450,resizable=yes,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Twitter" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></svg>
	</a>
	<a class="share__link btn" title="Share on Reddit" href="https://www.reddit.com/submit?url=https%3a%2f%2fh4ns21.github.io%2fblog%2fpost%2frever247ez%2f&amp;title=247CTF%20Easy%20Challs%20%5b%20Reversing%20%5d" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Share on Reddit', 'width=832,height=624,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Reddit" role="img" width="32" height="32" viewBox="0 0 512 512"><path fill-rule="evenodd" d="M375 146a32 32 0 1 0-29-46l-65-13c-5-1-9 2-10 6l-22 97c-45 1-85 15-113 36a42 42 0 1 0-45 69l-1 12c0 65 74 117 166 117s166-52 166-117l-1-11a42 42 0 1 0-44-69c-28-21-67-35-111-37l19-86 58 13a32 32 0 0 0 32 29zM190 353c2-1 4 0 5 1 15 11 38 18 61 18s46-6 61-18a7 7 0 0 1 8 10c-18 14-44 21-69 21-25-1-51-7-69-21a6 6 0 0 1 3-11zm23-44a31 31 0 1 1-44-44 31 31 0 0 1 44 44zm130 0a31 31 0 1 0-44-44 31 31 0 0 0 44 44z"/></svg>
	</a>
	<a class="share__link btn" title="Share on LinkedIn" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fh4ns21.github.io%2fblog%2fpost%2frever247ez%2f&title=247CTF%20Easy%20Challs%20%5b%20Reversing%20%5d" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Share on LinkedIn', 'width=640,height=480,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="LinkedIn" role="img" width="32" height="32" viewBox="0 0 512 512"><circle cx="142" cy="138" r="37"/><path stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
	</a>
</div>
				</footer>
				
			</article>
		</div>
	</main>
	
<div class="authorbox block">
	<div class="author">
		<figure class="author__avatar">
			<img class="author__img" alt="H4ns avatar" src="/blog/img/runa.jpg" height="90" width="90">
		</figure>
		<div class="author__body">
			<div class="author__name">
				H4ns
			</div>
			<div class="author__bio">I&#39;m a 19 years old cybersecurity enthusiast.</div>
		</div>
	</div>
</div>
	



	

	</div>
	<footer class="footer">
<div class="footer__social social">
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="mailto:alvaromansoporteiro@gmail.com">
			<svg class="social__icon" aria-label="Email" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M299 268l124 106c-4 4-10 7-17 7H106c-7 0-13-3-17-7l124-106 43 38 43-38zm-43 13L89 138c4-4 10-7 17-7h300c7 0 13 3 17 7L256 281zm54-23l121-105v208L310 258zM81 153l121 105L81 361V153z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://twitter.com/h4ns21">
			<svg class="social__icon" aria-label="Twitter" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://www.instagram.com/alvarinhogz">
			<svg class="social__icon" aria-label="Instagram" role="img" width="32" height="32" viewBox="0 0 512 512"><g fill="none" stroke-width="29"><rect height="296" rx="78" width="296" x="108" y="108"/><circle cx="256" cy="256" r="69"/></g><circle cx="343" cy="169" r="19"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://github.com/h4ns21">
			<svg class="social__icon" aria-label="Github" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
		</a>
</div>
	<div class="footer__copyright">© 2022 H4ns. <span class="footer__copyright-credits">Powered by <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/vimux/binario" rel="nofollow noopener" target="_blank">Binario</a> theme.</span></div>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>

<script src="/blog/js/custom.js"></script>
</body>
</html>